<?php if(isset($this->banner_data[$this->banner_type]) && $this->banner_data[$this->banner_type] != false): ?>

<?php
	$total_width = 0;
	foreach($this->banner_data[$this->banner_type] as $key => $val){
		$total_width += $val['width'];
		$total_width += 26;
	}

	if($total_width > 320){
		$narrow_arw = true;
		$narrow_width = $total_width+72;
	}else{
		$narrow_arw = false;
		$narrow_width = $total_width;
	}
	if($total_width > 480){
		$wide_arw = true;
		$wide_width = $total_width+72;
	}else{
		$wide_arw = false;
		$wide_width = $total_width;
	}

?>

<div id="flickable_narrow" style="display:none">
	<ul style="width:<?php echo $this->escape($narrow_width); ?>px">
	<?php if($narrow_arw): ?>
		<li><img src="<?php echo $this->escape($this->common_url); ?>s_images/icon/iconArrow_L.gif" /></li>
	<?php endif; ?>
	<?php foreach($this->banner_data[$this->banner_type] as $key => $val): ?>
		<li>
<?php
	// 予約企画バナーの場合は、リンクとターゲットを変更
	if (isset($val['reserve_event_id']) && $val['reserve_event_id'] != '') {
		$_target = ' target="'.$this->escape($this->site_code.'rsrv'.$val['reserve_event_id']).'"';
		$val['link_url'] = $this->reservesp_url . 'index.php?rvid='.$val['reserve_event_id'];
		$_a_tag_start = '<a href="'.$this->escape($val['link_url']).'"'.$_target.'>';
		$_a_tag_end   = '</a>';
		echo '<a href="'.$this->escape($val['link_url']).'"'.$_target.'>';
		echo '<img src="'.$this->escape($this->common_banner_url . $val['img_file']).'" alt="'.$this->escape($val['banner_alt']).'" />';
		echo $_a_tag_end."\n";
		if(strlen($val['banner_alt']) > 0){
			echo '<br/><a href="'.$this->escape($val['link_url']).'"><span class="banner_alt">'.$this->escape($val['banner_alt']).'</span></a>';
		}
	} else {
?>
		<?php if(strlen($val['link_url']) > 0): ?>
			<a href="<?php echo $this->escape($val['link_url']); ?>" <?php if($val['target_flg']==1): ?>target="_blank"<?php endif; ?> ><img src="<?php echo $this->escape($this->common_banner_url); ?><?php echo $this->escape($val['img_file']); ?>" /></a>
		<?php else: ?>
			<a onClick="return false;"><img src="<?php echo $this->escape($this->common_banner_url); ?><?php echo $this->escape($val['img_file']); ?>" /></a>
		<?php endif; ?>
		<?php if(strlen($val['banner_alt']) > 0): ?>
			<br/>
			<?php if(strlen($val['link_url']) > 0): ?>
			<a href="<?php echo $this->escape($val['link_url']); ?>" <?php if($val['target_flg']==1): ?>target="_blank"<?php endif; ?> ><span class="banner_alt"><?php echo mb_strimwidth($this->escape($val['banner_alt']), 0, $val['width']/5-1); ?></span></a>
			<?php else: ?>
			<span class="banner_alt"><?php echo mb_strimwidth($this->escape($val['banner_alt']), 0, $val['width']/5-1); ?></span>
			<?php endif; ?>
		<?php endif; ?>
<?php } ?>
		</li>
	<?php endforeach; ?>
	<?php if($narrow_arw): ?>
		<li><img src="<?php echo $this->escape($this->common_url); ?>s_images/icon/iconArrow_R.gif" /></li>
	<?php endif; ?>
	</ul>
	<div style="clear:both;"></div>
</div>

<div id="flickable_wide" style="display:none">
	<ul style="width:<?php echo $this->escape($wide_width); ?>px">
	<?php if($wide_arw): ?>
		<li><img src="<?php echo $this->escape($this->common_url); ?>s_images/icon/iconArrow_L.gif" /></li>
	<?php endif; ?>
	<?php foreach($this->banner_data[$this->banner_type] as $key => $val): ?>
		<li>
<?php
	// 予約企画バナーの場合は、リンクとターゲットを変更
	if (isset($val['reserve_event_id']) && $val['reserve_event_id'] != '') {
		$_target = ' target="'.$this->escape($this->site_code.'rsrv'.$val['reserve_event_id']).'"';
		$val['link_url'] = $this->reservesp_url . 'index.php?rvid='.$val['reserve_event_id'];
		$_a_tag_start = '<a href="'.$this->escape($val['link_url']).'"'.$_target.'>';
		$_a_tag_end   = '</a>';
		echo '<a href="'.$this->escape($val['link_url']).'"'.$_target.'>';
		echo '<img src="'.$this->escape($this->common_banner_url . $val['img_file']).'" alt="'.$this->escape($val['banner_alt']).'" />';
		echo $_a_tag_end."\n";
		if(strlen($val['banner_alt']) > 0){
			echo '<br/><a href="'.$this->escape($val['link_url']).'"><span class="banner_alt">'.$this->escape($val['banner_alt']).'</span></a>';
		}
	} else {
?>
		<?php if(strlen($val['link_url']) > 0): ?>
			<a href="<?php echo $this->escape($val['link_url']); ?>" <?php if($val['target_flg']==1): ?>target="_blank"<?php endif; ?> ><img src="<?php echo $this->escape($this->common_banner_url); ?><?php echo $this->escape($val['img_file']); ?>" /></a>
		<?php else: ?>
			<a onClick="return false;"><img src="<?php echo $this->escape($this->common_banner_url); ?><?php echo $this->escape($val['img_file']); ?>" /></a>
	<?php endif; ?>
		<?php if(strlen($val['banner_alt']) > 0): ?>
				<br/>
			<?php if(strlen($val['link_url']) > 0): ?>
			<a href="<?php echo $this->escape($val['link_url']); ?>" <?php if($val['target_flg']==1): ?>target="_blank"<?php endif; ?> ><span class="banner_alt"><?php echo mb_strimwidth($this->escape($val['banner_alt']), 0, $val['width']/5-1); ?></span></a>
			<?php else: ?>
			<span class="banner_alt"><?php echo mb_strimwidth($this->escape($val['banner_alt']), 0, $val['width']/5-1); ?></span>
			<?php endif; ?>
		<?php endif; ?>
<?php } ?>
		</li>
	<?php endforeach; ?>
	<?php if($wide_arw): ?>
		<li><img src="<?php echo $this->escape($this->common_url); ?>s_images/icon/iconArrow_R.gif" /></li>
	<?php endif; ?>
	</ul>
	<div style="clear:both;"></div>
</div>

<?php endif; ?>